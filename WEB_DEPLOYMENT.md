# üåê Web Deployment Guide - Make Your DR Assistant Accessible Online

This guide will help you deploy your DR Assistant so it's accessible through the web with a public URL.

## üéØ Deployment Strategy

**Recommended Approach:**
- **Frontend (HTML/JS)**: Deploy to **Netlify** (free, fast, easy)
- **API (Python/FastAPI)**: Deploy to **Railway** or **Render** (supports Python/ML)

---

## üìã Step 1: Deploy API to Railway (Recommended)

### Why Railway?
- ‚úÖ Free tier available
- ‚úÖ No timeout limits
- ‚úÖ Supports Python/PyTorch
- ‚úÖ Easy GitHub integration
- ‚úÖ Automatic deployments

### Steps:

1. **Go to Railway**: https://railway.app
2. **Sign up** with GitHub
3. **Create New Project** ‚Üí **Deploy from GitHub repo**
4. **Select your repository**: `pathik1501/DR-assistant`
5. **Add Environment Variable**:
   - Key: `OPENAI_API_KEY`
   - Value: Your OpenAI API key
6. **Railway will automatically**:
   - Detect Python
   - Install dependencies
   - Start the API server
7. **Get your API URL**: Railway provides a URL like `https://dr-assistant-api.up.railway.app`

### Configure API Port:

Railway uses the `PORT` environment variable. Update `src/inference.py` to use it:

```python
# At the top of src/inference.py
import os
port = int(os.environ.get('PORT', 8080))

# At the bottom, change:
if __name__ == "__main__":
    uvicorn.run(app, host="0.0.0.0", port=port)
```

---

## üìã Step 2: Deploy Frontend to Netlify

### Steps:

1. **Go to Netlify**: https://app.netlify.com
2. **Sign up** with GitHub
3. **Add new site** ‚Üí **Import an existing project**
4. **Select your repository**: `pathik1501/DR-assistant`
5. **Build settings**:
   - **Base directory**: `frontend`
   - **Publish directory**: `frontend`
   - **Build command**: (leave empty - static site)
6. **Environment variables**:
   - Key: `API_URL`
   - Value: Your Railway API URL (e.g., `https://dr-assistant-api.up.railway.app`)
7. **Deploy site**

### Update Frontend to Use Environment Variable:

The frontend needs to read the API URL from Netlify's environment. Update `frontend/index.html`:

```html
<!-- Add this before closing </head> tag -->
<script>
  // Set API URL from Netlify environment variable
  window.API_URL = '%API_URL%' || 'http://localhost:8080';
</script>
```

Or update `frontend/app.js` to read from a config file:

```javascript
// Create frontend/config.js (will be generated by Netlify)
const API_URL = window.API_URL || 'http://localhost:8080';
```

---

## üîß Alternative: Deploy API to Render

### Steps:

1. **Go to Render**: https://render.com
2. **Sign up** with GitHub
3. **New** ‚Üí **Web Service**
4. **Connect repository**: `pathik1501/DR-assistant`
5. **Settings**:
   - **Name**: `dr-assistant-api`
   - **Environment**: `Python 3`
   - **Build Command**: `pip install -r requirements.txt`
   - **Start Command**: `python src/inference.py`
6. **Environment Variables**:
   - `OPENAI_API_KEY`: Your OpenAI key
   - `PORT`: `8080` (Render uses PORT env var)
7. **Deploy**

---

## üöÄ Quick Deploy Script

Create a script to automate deployment:

### For Railway (API):

```bash
# Install Railway CLI
npm i -g @railway/cli

# Login
railway login

# Link project
railway link

# Set environment variable
railway variables set OPENAI_API_KEY=your-key-here

# Deploy
railway up
```

### For Netlify (Frontend):

```bash
# Install Netlify CLI
npm install -g netlify-cli

# Login
netlify login

# Initialize
netlify init

# Set environment variable
netlify env:set API_URL https://your-api.up.railway.app

# Deploy
netlify deploy --prod
```

---

## üìù Update Frontend for Production

### Option 1: Use Netlify Environment Variable (Recommended)

Create `frontend/config.js`:

```javascript
// This will be replaced by Netlify during build
const API_URL = '%%API_URL%%';
```

Update `frontend/index.html`:

```html
<!-- Add before closing </head> -->
<script src="config.js"></script>
<script>
  // Fallback to localhost for local development
  window.API_URL = window.API_URL || API_URL || 'http://localhost:8080';
</script>
```

### Option 2: Use Build-time Replacement

Netlify can replace variables during build. Update `netlify.toml`:

```toml
[build]
  publish = "frontend"
  command = "echo 'API_URL=%API_URL%' > frontend/config.js"
```

---

## ‚úÖ Verification

### 1. Test API:
```bash
curl https://your-api.up.railway.app/health
# Should return: {"status":"healthy"}
```

### 2. Test Frontend:
- Open your Netlify URL
- Check browser console (F12) for errors
- Upload an image and test analysis

### 3. Check CORS:
If you see CORS errors, update `src/inference.py`:

```python
from fastapi.middleware.cors import CORSMiddleware

app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],  # Or specific Netlify URL
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

---

## üîí Security Notes

1. **API URL**: Don't hardcode in frontend code
2. **OpenAI Key**: Never expose in frontend
3. **CORS**: Restrict origins in production
4. **Rate Limiting**: Consider adding rate limits to API

---

## üêõ Troubleshooting

### API Not Responding:
- Check Railway/Render logs
- Verify `PORT` environment variable
- Check API health endpoint

### Frontend Can't Connect:
- Verify `API_URL` environment variable in Netlify
- Check browser console for CORS errors
- Test API URL directly in browser

### CORS Errors:
- Add CORS middleware to FastAPI
- Update `allow_origins` with your Netlify URL

---

## üìö Additional Resources

- **Railway Docs**: https://docs.railway.app
- **Netlify Docs**: https://docs.netlify.com
- **Render Docs**: https://render.com/docs

---

## üéâ You're Done!

Once deployed:
- **Frontend URL**: `https://your-app.netlify.app`
- **API URL**: `https://your-api.up.railway.app`

Share your frontend URL with others to use your DR Assistant!

---

## üí° Pro Tips

1. **Custom Domain**: Add custom domain in Netlify settings
2. **Auto Deploy**: Enable auto-deploy on Git push
3. **Preview Deploys**: Netlify creates previews for PRs
4. **Monitoring**: Use Railway/Render logs for debugging

---

**Need Help?** Check the deployment logs in Railway/Netlify dashboards.

